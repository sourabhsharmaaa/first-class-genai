/Users/sourabh/Desktop/genaiproject-1/first-class-genai/phase1_data_ingestion/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
INFO:     Started server process [75006]
INFO:     Waiting for application startup.
INFO:phase4_api_service.main:Loading Zomato dataset into memory...
INFO:data_ingestion:Loading dataset ManikaSaini/zomato-restaurant-recommendation from Hugging Face...
INFO:httpx:HTTP Request: HEAD https://huggingface.co/datasets/ManikaSaini/zomato-restaurant-recommendation/resolve/main/README.md "HTTP/1.1 404 Not Found"
INFO:httpx:HTTP Request: GET https://huggingface.co/api/datasets/ManikaSaini/zomato-restaurant-recommendation "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: HEAD https://huggingface.co/datasets/ManikaSaini/zomato-restaurant-recommendation/resolve/5738e9eda2fad49ad51c6e0ed26e761d9b947133/zomato-restaurant-recommendation.py "HTTP/1.1 404 Not Found"
INFO:httpx:HTTP Request: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/ManikaSaini/zomato-restaurant-recommendation/ManikaSaini/zomato-restaurant-recommendation.py "HTTP/1.1 404 Not Found"
INFO:httpx:HTTP Request: HEAD https://huggingface.co/datasets/ManikaSaini/zomato-restaurant-recommendation/resolve/5738e9eda2fad49ad51c6e0ed26e761d9b947133/README.md "HTTP/1.1 404 Not Found"
INFO:httpx:HTTP Request: GET https://huggingface.co/api/datasets/ManikaSaini/zomato-restaurant-recommendation/revision/5738e9eda2fad49ad51c6e0ed26e761d9b947133 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: HEAD https://huggingface.co/datasets/ManikaSaini/zomato-restaurant-recommendation/resolve/5738e9eda2fad49ad51c6e0ed26e761d9b947133/.huggingface.yaml "HTTP/1.1 404 Not Found"
INFO:httpx:HTTP Request: GET https://datasets-server.huggingface.co/info?dataset=ManikaSaini/zomato-restaurant-recommendation "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://huggingface.co/api/datasets/ManikaSaini/zomato-restaurant-recommendation/tree/5738e9eda2fad49ad51c6e0ed26e761d9b947133/data?recursive=true&expand=false "HTTP/1.1 404 Not Found"
INFO:httpx:HTTP Request: GET https://huggingface.co/api/datasets/ManikaSaini/zomato-restaurant-recommendation/tree/5738e9eda2fad49ad51c6e0ed26e761d9b947133?recursive=false&expand=false "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: HEAD https://huggingface.co/datasets/ManikaSaini/zomato-restaurant-recommendation/resolve/5738e9eda2fad49ad51c6e0ed26e761d9b947133/dataset_infos.json "HTTP/1.1 404 Not Found"
INFO:data_ingestion:Dataset loaded with 51717 rows and 17 columns.
INFO:data_ingestion:Dropped 39218 duplicate restaurants.
INFO:phase4_api_service.main:Dataset loaded successfully with 12499 rows.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     127.0.0.1:50427 - "GET /health HTTP/1.1" 200 OK
INFO:phase4_api_service.main:Parsing search query: burger in indiranagar under 500 under 4 starsburger in indiranagar under 500 under 4 stars
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:phase4_api_service.main:Parsed filters: {'location': 'Indiranagar', 'cuisine': 'Burger', 'max_price': 500, 'min_rating': 4.0, 'max_rating': None}
INFO:retrieval:After strict location filter 'Indiranagar': 532 restaurants
INFO:retrieval:After cuisine filter 'Burger': 23 restaurants
INFO:retrieval:After max price filter 500.0: 9 restaurants
INFO:retrieval:After min rating filter 4.0: 1 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:50437 - "POST /recommend HTTP/1.1" 200 OK
INFO:phase4_api_service.main:Parsing search query: burger in indiranagar under 500 under 4 starsburger in indiranagar under 500 under 4 starsburger in indiranagar under 500 under 4 stars
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:phase4_api_service.main:Parsed filters: {'location': 'Indiranagar', 'cuisine': 'Burger', 'max_price': 500, 'min_rating': None, 'max_rating': 4.0}
INFO:retrieval:After strict location filter 'Indiranagar': 532 restaurants
INFO:retrieval:After cuisine filter 'Burger': 23 restaurants
INFO:retrieval:After max price filter 500.0: 9 restaurants
INFO:retrieval:After min rating filter 4.0: 1 restaurants
INFO:retrieval:After max rating filter 4.0: 0 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:50444 - "POST /recommend HTTP/1.1" 200 OK
INFO:phase4_api_service.main:Parsing search query: burger in indiranagar under 500 under 4 stars
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:phase4_api_service.main:Parsed filters: {'location': 'Indiranagar', 'cuisine': 'Burger', 'max_price': 500, 'min_rating': None, 'max_rating': 4.0}
INFO:retrieval:After strict location filter 'Indiranagar': 532 restaurants
INFO:retrieval:After cuisine filter 'Burger': 23 restaurants
INFO:retrieval:After max price filter 500.0: 9 restaurants
INFO:retrieval:After min rating filter 3.0: 6 restaurants
INFO:retrieval:After max rating filter 4.0: 5 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:50449 - "POST /recommend HTTP/1.1" 200 OK
INFO:phase4_api_service.main:Parsing search query: burger above 4 stars
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:phase4_api_service.main:Parsed filters: {'location': None, 'cuisine': 'Burger', 'max_price': None, 'min_rating': 4.0, 'max_rating': None}
INFO:retrieval:After strict location filter 'Indiranagar': 532 restaurants
INFO:retrieval:After cuisine filter 'Burger': 23 restaurants
INFO:retrieval:After max price filter 500.0: 9 restaurants
INFO:retrieval:After min rating filter 4.0: 1 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:50459 - "POST /recommend HTTP/1.1" 200 OK
INFO:phase4_api_service.main:Parsing search query: burger above 4 stars
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:phase4_api_service.main:Parsed filters: {'location': None, 'cuisine': 'Burger', 'max_price': None, 'min_rating': 4.0, 'max_rating': None}
INFO:retrieval:After strict location filter 'Indiranagar': 532 restaurants
INFO:retrieval:After cuisine filter 'Burger': 23 restaurants
INFO:retrieval:After max price filter 1000.0: 18 restaurants
INFO:retrieval:After min rating filter 4.0: 9 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:50490 - "POST /recommend HTTP/1.1" 200 OK
INFO:     127.0.0.1:50613 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:50614 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:50669 - "OPTIONS /recommend HTTP/1.1" 200 OK
INFO:retrieval:After strict location filter 'Banashankari': 295 restaurants
INFO:retrieval:After cuisine filter 'BBQ': 0 restaurants
INFO:retrieval:After max price filter 5000.0: 0 restaurants
INFO:retrieval:After min rating filter 4.5: 0 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:50669 - "POST /recommend HTTP/1.1" 200 OK
INFO:retrieval:After strict location filter 'Banashankari': 295 restaurants
INFO:retrieval:After cuisine filter 'Cafe': 25 restaurants
INFO:retrieval:After max price filter 1000.0: 25 restaurants
INFO:retrieval:After min rating filter 4.0: 7 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:50808 - "POST /recommend HTTP/1.1" 200 OK
INFO:     127.0.0.1:51140 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:51141 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:51419 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:51420 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:51422 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:51423 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:51455 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:51454 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:51457 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:51458 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:51488 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:51489 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:52501 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:52502 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:54985 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:54986 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:55890 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:55891 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:55905 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:55906 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:56548 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:56549 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:56845 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:56846 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:58044 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:58045 - "GET /cuisines HTTP/1.1" 200 OK
INFO:retrieval:After strict location filter 'Bellandur': 363 restaurants
INFO:retrieval:After cuisine filter 'American': 3 restaurants
INFO:retrieval:After max price filter 4000.0: 3 restaurants
INFO:retrieval:After min rating filter 3.5: 2 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:58046 - "POST /recommend HTTP/1.1" 200 OK
INFO:retrieval:After strict location filter 'Bellandur': 363 restaurants
INFO:retrieval:After cuisine filter 'American': 3 restaurants
INFO:retrieval:After max price filter 4000.0: 3 restaurants
INFO:retrieval:After min rating filter 3.5: 2 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:58049 - "POST /recommend HTTP/1.1" 200 OK
INFO:     127.0.0.1:58317 - "OPTIONS /recommend HTTP/1.1" 200 OK
INFO:retrieval:After strict location filter 'Bommanahalli': 100 restaurants
INFO:retrieval:After cuisine filter 'Andhra': 8 restaurants
INFO:retrieval:After max price filter 1000.0: 8 restaurants
INFO:retrieval:After min rating filter 3.5: 3 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:58317 - "POST /recommend HTTP/1.1" 200 OK
INFO:     127.0.0.1:58441 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:58442 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:58451 - "OPTIONS /recommend HTTP/1.1" 200 OK
INFO:phase4_api_service.main:Parsing search query: pizza
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:phase4_api_service.main:Parsed filters: {'location': None, 'cuisine': 'pizza', 'max_price': None, 'min_rating': None, 'max_rating': None}
INFO:retrieval:After cuisine filter 'pizza': 439 restaurants
INFO:retrieval:After max price filter 1000.0: 378 restaurants
INFO:retrieval:After min rating filter 4.0: 120 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:58451 - "POST /recommend HTTP/1.1" 200 OK
INFO:phase4_api_service.main:Parsing search query: pizza
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:phase4_api_service.main:Parsed filters: {'location': None, 'cuisine': 'pizza', 'max_price': None, 'min_rating': None, 'max_rating': None}
INFO:retrieval:After cuisine filter 'pizza': 439 restaurants
INFO:retrieval:After max price filter 5000.0: 436 restaurants
INFO:retrieval:After min rating filter 4.0: 165 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:58471 - "POST /recommend HTTP/1.1" 200 OK
INFO:     127.0.0.1:58532 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:58533 - "GET /cuisines HTTP/1.1" 200 OK
INFO:phase4_api_service.main:Parsing search query: pizza
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:phase4_api_service.main:Parsed filters: {'location': None, 'cuisine': 'pizza', 'max_price': None, 'min_rating': None, 'max_rating': None}
INFO:retrieval:After cuisine filter 'pizza': 439 restaurants
INFO:retrieval:After max price filter 1000.0: 378 restaurants
INFO:retrieval:After min rating filter 4.0: 120 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:58535 - "POST /recommend HTTP/1.1" 200 OK
INFO:     127.0.0.1:58550 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:58551 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     127.0.0.1:58610 - "OPTIONS /recommend HTTP/1.1" 200 OK
INFO:retrieval:After strict location filter 'Basaveshwara Nagar': 105 restaurants
INFO:retrieval:After cuisine filter 'African': 0 restaurants
INFO:retrieval:After max price filter 2000.0: 0 restaurants
INFO:retrieval:After min rating filter 4.0: 0 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:58610 - "POST /recommend HTTP/1.1" 200 OK
INFO:retrieval:After strict location filter 'Cunningham Road': 49 restaurants
INFO:retrieval:After cuisine filter 'Awadhi': 1 restaurants
INFO:retrieval:After max price filter 2000.0: 1 restaurants
INFO:retrieval:After min rating filter 4.0: 1 restaurants
INFO:llm_recommender:Sending prompt to Groq API...
INFO:httpx:HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:     127.0.0.1:58610 - "POST /recommend HTTP/1.1" 200 OK
INFO:     127.0.0.1:58647 - "GET /locations HTTP/1.1" 200 OK
INFO:     127.0.0.1:58648 - "GET /cuisines HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [75006]
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
